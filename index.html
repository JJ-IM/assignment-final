<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="UTF-8">
    <title>í‚¹ì½©ë¨¸ë‹ˆ ğŸ’¸</title>
    <link rel="icon" type="image/x-icon" href="./assets/img/main/DK_icon.ico">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/nav.css">
    <script src="./JS/auth.js" defer></script>
</head>
<body>
    <video autoplay loop muted playsinline id="bg-video" style="filter: blur(3px);">
        <source src="./assets/video/Red_Smok.mp4" type="video/mp4">
    </video>

    <div id="content">
        <!-- ì´ê³³ì— JavaScriptì— ì˜í•´ ì»¨í…ì¸ ê°€ ë¡œë“œë©ë‹ˆë‹¤. -->
    </div>

    <script>
        async function loadContent() {
            const contentDiv = document.getElementById('content');
            const userData = await validateCookie();

            if (!getCookie("PHPSESSID")) {
                // ì¿ í‚¤ê°€ ì—†ëŠ” ìƒíƒœ
                contentDiv.innerHTML = `
                    <div class="top-box">
                        <div class="blackjack-img-container">
                            <img src="./assets/img/main/BlackJack.png" id="main-black" alt="Blackjack" class="blackjack-img">
                        </div>
                    </div>
                    <div class="mid-box"></div>
                    <div class="bot-box">
                        <div class="dealer-img-container">
                            <img src="./assets/img/main/dealer.png" id="dealer_img" alt="Blackjack" class="dealer-img">
                        </div>
                        <div class="button-container">
                            <div class="button-wrapper">
                                <a href="./HTML/SignIn.html" class="button">
                                    <img src="./assets/img/navbar/SignIn.svg" alt="Sign In Icon" class="button-icon">
                                    <span class="button-text"> ë¡œê·¸ì¸ </span>
                                </a>
                            </div>
                            <div class="button-wrapper">
                                <a href="./HTML/SignUp.html" class="button">
                                    <img src="./assets/img/navbar/SignUp.svg" alt="Sign Up Icon" class="button-icon">
                                    <span class="button-text"> íšŒì›ê°€ì… </span>
                                </a>
                            </div>
                        </div>
                    </div>
                `;
            } else if (!userData) {
                // ì¿ í‚¤ê°€ ìˆëŠ”ë° ìœ íš¨í•˜ì§€ ì•Šì€ ìƒíƒœ
                await logout();
            } else {
                const { username, coins } = userData;
                // ì¿ í‚¤ê°€ ìœ íš¨í•œ ìƒíƒœ
                contentDiv.innerHTML = `
                    <div class="top-box">
                        <div class="blackjack-img-container">
                            <img src="./assets/img/main/BlackJack.png" id="main-black" alt="Blackjack" class="blackjack-img">
                        </div>
                    </div>
                    <div class="mid-box"></div>
                    <div class="bot-box">
                        <div class="dealer-img-container">
                            <img src="./assets/img/main/dealer.png" id="dealer_img" alt="Blackjack" class="dealer-img">
                        </div>
                        <div class="user-info">
                            <p>ë‹‰ë„¤ì„: ${username}</p>
                            <p>ì½”ì¸: ${coins}</p>
                        </div>
                        <div class="button-container">
                            <div class="button-wrapper">
                                <a href="./HTML/Ranking.html" class="button">
                                    <img src="./assets/img/navbar/Ranking.svg" alt="Ranking" class="button-icon">
                                    <span class="button-text"> ë­í‚¹ </span>
                                </a>
                            </div>
                            <div class="button-wrapper">
                                <a href="./HTML/History.html" class="button">
                                    <img src="./assets/img/navbar/History.svg" alt="History" class="button-icon">
                                    <span class="button-text"> ê¸°ë¡ </span>
                                </a>
                            </div>
                            <div class="button-wrapper">
                                <a href="./HTML/Play.html" class="button">
                                    <img src="./assets/img/navbar/Play.svg" alt="Play" class="button-icon">
                                    <span class="button-text"> ì‹œì‘ </span>
                                </a>
                            </div>
                            <div class="button-wrapper">
                                <a href="./HTML/Mypage.html" class="button">
                                    <img src="./assets/img/navbar/Mypage.svg" alt="Mypage" class="button-icon">
                                    <span class="button-text"> ì •ë³´ </span>
                                </a>
                            </div>
                        </div>
                    </div>
                `;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì»¨í…ì¸  ë¡œë“œ
        window.onload = loadContent;
    </script>
</body>
</html>
